//Defines the whole left side song drag-and-drop / recognition area.
define(["recognitionArea","audioScrobbler","recognitionList","backend","recognitionImageBuilder"],function(e,t,n,r,i){"use strict";function s(e){t.getData(e.title,function(s){var o=parseInt(s.results["opensearch:totalResults"],10);if(o!==0){var u=o===1?s.results.trackmatches.track:s.results.trackmatches.track[0],a=i.buildThumbnailImage(e);n.addImageToCurrentSong(a);t.getAlbum(u.name,u.artist,function(t){var s=t.track,o=s.album;o===undefined?o={title:"Unknown",image:"data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw=="}:o.image=o.image[o.image.length-1]["#text"];var u=i.buildAlbumImage(o);n.addImageToCurrentSong(u);r.onSaveData(function(t,r){var s=i.buildSongDurationDiv(e);n.addImageToCurrentSong(s);n.showFinishedAnimation(r)});r.saveData({hoster:"youtube",hosterid:e.id,title:s.name,artists:s.artist.name,album:o.title,cover:o.image,id:s.id,countries:e.restrictedCountries,duration:e.duration,artistsid:s.artist.mbid,albumid:o.mbid})})}})}function o(e,t){var n=e;e.indexOf(t)!==-1&&(n=e.substr(0,e.indexOf(t)));return n}e.onSongDropped(function(e,t){n.addSong(t);var r=i.buildYoutubeMetroImage();n.addImageToCurrentSong(r);var o=["HD","official","video","-","audio","lyrics","feat","ft."];$.each(o,function(e,n){var r=new RegExp(n,"gi");t.title=t.title.replace(r,"")});s(t)});e.onLinkNotRecognized(function(){var e=$("<p>",{"class":"fadeandslide",text:strings.linkNotRecognized[window.language]});n.addNotice(e)});return{}});